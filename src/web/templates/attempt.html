<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>SumarAi</title>
    <style>
      body { font-family: Arial; max-width: 900px; margin: 40px auto; background-image:url("https://images.stockcake.com/public/f/e/7/fe708eef-def9-4d3e-b06f-f46d405fbf85/misty-sakura-mountains-stockcake.jpg"); 
      background-size: fill; background-position: center; background-repeat: no-repeat;background-attachment: fixed;}
      textarea { width: 100%; height: 220px;background-color: rgb(255, 240, 255); }
      .row { display: flex; gap: 10px; margin-top: 10px; align-items: center; flex-wrap: wrap; }
      button, select { padding: 10px 14px; cursor: pointer; }
      .box { margin-top: 20px; padding: 12px; border: 1px solid #ddd; border-radius: 8px; }
      .error { color: #b00020; }
      .logo {position: relative;top: 25px;  left: 0px; }
      .title{font-family: Colonna MT; font-size: 1.2cm;}
      .fixed_logo{position: fixed ; bottom: 0px ; right: 15px }
      .btn_athena{background-color: rgb(251, 166, 255); border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; border-top-left-radius: 20px; border-top-right-radius: 20px;}
      .btn_athena:hover{background-color: rgb(249, 130, 255) ;}

      .btn_athena_sel{background-color: rgb(251, 229, 252);border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; border-top-left-radius: 20px; border-top-right-radius: 20px;}
    </style>
  </head>

  <body>
    <h1 style="color:rgb(255, 64, 156)"; class="title"> <img src="/static/images/SamurAi.png" width="70" class="logo">SumarAi</h1> 

    {% if error %}
      <p class="error">{{ error }}</p>
    {% endif %}

    <form method="post">
      <textarea name="text" placeholder="Paste text here...">{{ text or "" }}</textarea>

      <div class="row">
        <!-- Run actions -->
        <button type="submit" formaction="/run" name="action" value="summary" class="btn_athena">Summarize</button>
        <button type="submit" formaction="/run" name="action" value="quiz" class="btn_athena">Generate Quiz</button>
        <button type="submit" formaction="/run" name="action" value="both" class="btn_athena">Do Both</button>
      </div>
        <!-- Export controls -->
      <br>
        <label style="font-family: Colonna MT ; font-size: 1cm;">  Export:</label>

      <div class="row">
        <select name="export_what" class="btn_athena_sel">
          <option value="both">Summary + Quiz</option>
          <option value="summary">Summary only</option>
          <option value="quiz">Quiz only</option>
        </select>

        <select name="format" class="btn_athena_sel">
          <option value="pdf">PDF</option>
          <option value="json">JSON</option>
          <option value="html">HTML</option>
          <option value="markdown">Markdown</option>
          <option value="anki">Anki (.apkg)</option>
        </select>

        <button type="submit" formaction="/export" class="btn_athena">Export</button>
      </div>
    </form>

    {% if summary %}
      <div class="box">
        <h2>Summary</h2>

        {% if title %}
          <h3>{{ title }}</h3>
        {% endif %}

        <p style="white-space: pre-wrap;">{{ summary }}</p>

        {% if bullet_points %}
          <h3>Points clés</h3>
          <ul>
            {% for p in bullet_points %}
              <li>{{ p }}</li>
            {% endfor %}
          </ul>
        {% endif %}

        {% if key_concepts %}
          <h3>Concepts clés</h3>
          <p>{{ key_concepts | join(", ") }}</p>
        {% endif %}

        {% if sources %}
          <h3>Sources</h3>
          <ul>
            {% for s in sources %}
              <li>{{ s }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      </div>
    {% endif %}

    {% if quiz %}
      <div class="box">
        <h2>Quiz</h2>
        {% for q in quiz %}
          <div style="margin-bottom: 16px;">
            <strong>{{ loop.index }}. {{ q.question }}</strong>

            <ul>
              {% for opt in q.options %}
                <li>{{ opt }}</li>
              {% endfor %}
            </ul>

            <details>
              <summary>Answer</summary>
              <p>{{ q.answer }}</p>
              <p><em>Difficulty: {{ q.difficulty }}</em></p>
            </details>
          </div>
        {% endfor %}
      </div>
    {% endif %}
    <img src="/static/images/Sakura.png" class="fixed_logo" width="200"> 
  </body>
</html>
